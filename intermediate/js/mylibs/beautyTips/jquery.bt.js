jQuery.bt={version:"0.9.5-rc1"};
(function(b){jQuery.fn.bt=function(m,n){function y(a,b){this.moveTo(a[0].x,a[0].y);for(i=1;i<a.length;i++)a[i-1].type=="arcStart"?(this.quadraticCurveTo(t(a[i].x,b),t(a[i].y,b),t(a[(i+1)%a.length].x,b),t(a[(i+1)%a.length].y,b)),i++):this.lineTo(t(a[i].x,b),t(a[i].y,b))}function t(a,b){b=e(b);return b%2?a:Math.round(a-0.5)+0.5}function e(a){return parseInt(a)||0}function z(a,b){var e,f=[];for(e in a)a[e]!=b&&f.push(a[e]);return f}function L(){try{var a=navigator.userAgent.toLowerCase();if(/webkit/.test(a))return!0;
else if(/gecko|mozilla/.test(a)&&parseFloat(a.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1)return!0}catch(b){}return!1}function G(a,b,e){if(a.x==b.x)return b=a.y<b.y?a.y+e:a.y-e,{x:a.x,y:b};else if(a.y==b.y)return b=a.x<b.x?a.x+e:a.x-e,{x:b,y:a.y}}function H(a,b,e,f,k){if(b==f)return{x:k,y:b};e=(b-f)/(a-e);return{x:k,y:e*k+(b-e*a)}}function I(a,b,e,f,k){if(a==e)return{x:a,y:k};e=(b-f)/(a-e);return{x:(k-(b-e*a))/e,y:k}}if(typeof m!="string")var J=!0,n=m,m=!1;else J=!1;if(jQuery.fn.hoverIntent&&jQuery.bt.defaults.trigger==
"hover")jQuery.bt.defaults.trigger="hoverIntent";return this.each(function(){var a=jQuery.extend(!1,jQuery.bt.defaults,jQuery.bt.options,n);a.spikeLength=e(a.spikeLength);a.spikeGirth=e(a.spikeGirth);a.overlap=e(a.overlap);var t=!1;a.killTitle&&b(this).find("[title]").andSelf().each(function(){b(this).attr("bt-xTitle")||b(this).attr("bt-xTitle",b(this).attr("title")).attr("title","")});if(typeof a.trigger=="string")a.trigger=[a.trigger];if(a.trigger[0]=="hoverIntent"){var K=jQuery.extend(a.hoverIntentOpts,
{over:function(){this.btOn()},out:function(){this.btOff()}});b(this).hoverIntent(K)}else a.trigger[0]=="hover"?b(this).hover(function(){this.btOn()},function(){this.btOff()}):a.trigger[0]=="now"?b(this).hasClass("bt-active")?this.btOff():this.btOn():a.trigger[0]!="none"&&(a.trigger.length>1&&a.trigger[0]!=a.trigger[1]?b(this).bind(a.trigger[0],function(){this.btOn()}).bind(a.trigger[1],function(){this.btOff()}):b(this).bind(a.trigger[0],function(){b(this).hasClass("bt-active")?this.btOff():this.btOn()}));
this.btOn=function(){var f,k;typeof b(this).data("bt-box")=="object"&&this.btOff();a.preBuild.apply(this);b(jQuery.bt.vars.closeWhenOpenStack).btOff();b(this).addClass("bt-active "+a.activeClass);J&&a.ajaxPath==null&&(a.killTitle&&b(this).attr("title",b(this).attr("bt-xTitle")),m=b.isFunction(a.contentSelector)?a.contentSelector.apply(this):eval(a.contentSelector),a.killTitle&&b(this).attr("title",""));if(a.ajaxPath!=null&&m==!1){if(typeof a.ajaxPath=="object"){var n=eval(a.ajaxPath[0]);n+=a.ajaxPath[1]?
" "+a.ajaxPath[1]:""}else n=a.ajaxPath;var r=n.indexOf(" ");if(r>=0)var C=n.slice(r,n.length),n=n.slice(0,r);r=a.ajaxCache?b(document.body).data("btCache-"+n.replace(/\./g,"")):null;if(typeof r=="string")m=C?b("<div/>").append(r.replace(/<script(.|\s)*?\/script>/g,"")).find(C):r;else{var z=this,r=jQuery.extend(!1,{type:a.ajaxType,data:a.ajaxData,cache:a.ajaxCache,url:n,complete:function(c,d){d=="success"||d=="notmodified"?(a.ajaxCache&&b(document.body).data("btCache-"+n.replace(/\./g,""),c.responseText),
t=!1,m=C?b("<div/>").append(c.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(C):c.responseText):(d=="timeout"&&(t=!0),m=a.ajaxError.replace(/%error/g,c.statusText));b(z).hasClass("bt-active")&&z.btOn()}},a.ajaxOpts);jQuery.ajax(r);m=a.ajaxLoading}}var o=0,s=0,w=r=0;if(a.shadow&&!L())a.shadow=!1,jQuery.extend(a,a.noShadowOpts);a.shadow&&(o=a.shadowBlur>Math.abs(a.shadowOffsetX)?a.shadowBlur*2:a.shadowBlur+Math.abs(a.shadowOffsetX),r=a.shadowBlur-a.shadowOffsetX>0?a.shadowBlur-a.shadowOffsetX:
0,s=a.shadowBlur>Math.abs(a.shadowOffsetY)?a.shadowBlur*2:a.shadowBlur+Math.abs(a.shadowOffsetY),w=a.shadowBlur-a.shadowOffsetY>0?a.shadowBlur-a.shadowOffsetY:0);if(a.offsetParent)var D=b(a.offsetParent),x=D.offset(),v=b(this).offset(),A=e(v.top)-e(x.top)+e(b(this).css("margin-top"))-w,x=e(v.left)-e(x.left)+e(b(this).css("margin-left"))-r;else D=b(this).css("position")=="absolute"?b(this).parents().eq(0).offsetParent():b(this).offsetParent(),v=b(this).btPosition(),A=e(v.top)+e(b(this).css("margin-top"))-
w,x=e(v.left)+e(b(this).css("margin-left"))-r;var v=b(this).btOuterWidth(),E=b(this).outerHeight();if(typeof m=="object"){var h=m,d=b(h).clone(!0).show(),j=b(h).data("bt-clones")||[];j.push(d);b(h).data("bt-clones",j);b(d).data("bt-orig",h);b(this).data("bt-content-orig",{original:h,clone:d});m=d}if(!(typeof m=="null"||m=="")){d=b('<div class="bt-content"></div>').append(m).css({padding:a.padding,position:"absolute",width:a.shrinkToFit?"auto":a.width,zIndex:a.textzIndex,left:r,top:w}).css(a.cssStyles);
h=b('<div class="bt-wrapper"></div>').append(d).addClass(a.cssClass).css({position:"absolute",width:a.width,zIndex:a.wrapperzIndex,visibility:"hidden"}).appendTo(D);jQuery.fn.bgiframe&&(d.bgiframe(),h.bgiframe());b(this).data("bt-box",h);var j=e(b(document).scrollTop()),p=e(b(document).scrollLeft());k=e(b(window).width());var B=e(b(window).height()),q=p+k,l=j+B;f={};var F=b(this).offset();f.top=F.top-j;f.bottom=B-(F+E-j);f.left=F.left-p;f.right=k-(F.left+v-p);k=e(d.outerHeight());B=e(d.btOuterWidth());
if(a.positions.constructor==String)a.positions=a.positions.replace(/ /,"").split(",");if(a.positions[0]=="most"){var u="top",c;for(c in f)u=f[c]>f[u]?c:u}else for(var g in a.positions)if(u=a.positions[g],(u=="left"||u=="right")&&f[u]>B+a.spikeLength)break;else if((u=="top"||u=="bottom")&&f[u]>k+a.spikeLength)break;g=x+(v-B)*0.5;f=A+(E-k)*0.5;c=[];switch(u){case "top":d.css("margin-bottom",a.spikeLength+"px");h.css({top:A-d.outerHeight(!0)+a.overlap,left:g});g=q-a.windowMargin-(d.offset().left+d.btOuterWidth(!0));
l=r;g<0&&(h.css("left",e(h.css("left"))+g+"px"),l-=g);g=d.offset().left+e(d.css("margin-left"))-(p+a.windowMargin);g<0&&(h.css("left",e(h.css("left"))-g+"px"),l+=g);g=d.btPosition().top+e(d.css("margin-top"));j=d.btPosition().left+e(d.css("margin-left"));p=j+d.btOuterWidth();q=g+d.outerHeight();f=j+d.btOuterWidth()*a.centerPointX;k=g+d.outerHeight()*a.centerPointY;c[c.length]=l={y:q+a.spikeLength,x:(p-j)*0.5+l,type:"spike"};f=I(l.x,l.y,f,k,q);f.x=f.x<j+a.spikeGirth/2+a.cornerRadius?j+a.spikeGirth/
2+a.cornerRadius:f.x;f.x=f.x>p-a.spikeGirth/2-a.cornerRadius?p-a.spikeGirth/2-a.CornerRadius:f.x;c[c.length]={x:f.x-a.spikeGirth/2,y:q,type:"join"};c[c.length]={x:j,y:q,type:"corner"};c[c.length]={x:j,y:g,type:"corner"};c[c.length]={x:p,y:g,type:"corner"};c[c.length]={x:p,y:q,type:"corner"};c[c.length]={x:f.x+a.spikeGirth/2,y:q,type:"join"};c[c.length]=l;break;case "left":d.css("margin-right",a.spikeLength+"px");h.css({top:f+"px",left:x-d.btOuterWidth(!0)+a.overlap+"px"});g=l-a.windowMargin-(d.offset().top+
d.outerHeight(!0));l=w;g<0&&(h.css("top",e(h.css("top"))+g+"px"),l-=g);g=d.offset().top+e(d.css("margin-top"))-(j+a.windowMargin);g<0&&(h.css("top",e(h.css("top"))-g+"px"),l+=g);g=d.btPosition().top+e(d.css("margin-top"));j=d.btPosition().left+e(d.css("margin-left"));p=j+d.btOuterWidth();q=g+d.outerHeight();f=j+d.btOuterWidth()*a.centerPointX;k=g+d.outerHeight()*a.centerPointY;c[c.length]=l={x:p+a.spikeLength,y:(q-g)*0.5+l,type:"spike"};f=H(l.x,l.y,f,k,p);f.y=f.y<g+a.spikeGirth/2+a.cornerRadius?g+
a.spikeGirth/2+a.cornerRadius:f.y;f.y=f.y>q-a.spikeGirth/2-a.cornerRadius?q-a.spikeGirth/2-a.cornerRadius:f.y;c[c.length]={x:p,y:f.y+a.spikeGirth/2,type:"join"};c[c.length]={x:p,y:q,type:"corner"};c[c.length]={x:j,y:q,type:"corner"};c[c.length]={x:j,y:g,type:"corner"};c[c.length]={x:p,y:g,type:"corner"};c[c.length]={x:p,y:f.y-a.spikeGirth/2,type:"join"};c[c.length]=l;break;case "bottom":d.css("margin-top",a.spikeLength+"px");h.css({top:A+E-a.overlap,left:g});g=q-a.windowMargin-(d.offset().left+d.btOuterWidth(!0));
l=r;g<0&&(h.css("left",e(h.css("left"))+g+"px"),l-=g);g=d.offset().left+e(d.css("margin-left"))-(p+a.windowMargin);g<0&&(h.css("left",e(h.css("left"))-g+"px"),l+=g);g=d.btPosition().top+e(d.css("margin-top"));j=d.btPosition().left+e(d.css("margin-left"));p=j+d.btOuterWidth();q=g+d.outerHeight();f=j+d.btOuterWidth()*a.centerPointX;k=g+d.outerHeight()*a.centerPointY;c[c.length]=l={x:(p-j)*0.5+l,y:w,type:"spike"};f=I(l.x,l.y,f,k,g);f.x=f.x<j+a.spikeGirth/2+a.cornerRadius?j+a.spikeGirth/2+a.cornerRadius:
f.x;f.x=f.x>p-a.spikeGirth/2-a.cornerRadius?p-a.spikeGirth/2-a.cornerRadius:f.x;c[c.length]={x:f.x+a.spikeGirth/2,y:g,type:"join"};c[c.length]={x:p,y:g,type:"corner"};c[c.length]={x:p,y:q,type:"corner"};c[c.length]={x:j,y:q,type:"corner"};c[c.length]={x:j,y:g,type:"corner"};c[c.length]={x:f.x-a.spikeGirth/2,y:g,type:"join"};c[c.length]=l;break;case "right":d.css("margin-left",a.spikeLength+"px"),h.css({top:f+"px",left:x+v-a.overlap+"px"}),g=l-a.windowMargin-(d.offset().top+d.outerHeight(!0)),l=w,
g<0&&(h.css("top",e(h.css("top"))+g+"px"),l-=g),g=d.offset().top+e(d.css("margin-top"))-(j+a.windowMargin),g<0&&(h.css("top",e(h.css("top"))-g+"px"),l+=g),g=d.btPosition().top+e(d.css("margin-top")),j=d.btPosition().left+e(d.css("margin-left")),p=j+d.btOuterWidth(),q=g+d.outerHeight(),f=j+d.btOuterWidth()*a.centerPointX,k=g+d.outerHeight()*a.centerPointY,c[c.length]=l={x:r,y:(q-g)*0.5+l,type:"spike"},f=H(l.x,l.y,f,k,j),f.y=f.y<g+a.spikeGirth/2+a.cornerRadius?g+a.spikeGirth/2+a.cornerRadius:f.y,f.y=
f.y>q-a.spikeGirth/2-a.cornerRadius?q-a.spikeGirth/2-a.cornerRadius:f.y,c[c.length]={x:j,y:f.y-a.spikeGirth/2,type:"join"},c[c.length]={x:j,y:g,type:"corner"},c[c.length]={x:p,y:g,type:"corner"},c[c.length]={x:p,y:q,type:"corner"},c[c.length]={x:j,y:q,type:"corner"},c[c.length]={x:j,y:f.y+a.spikeGirth/2,type:"join"},c[c.length]=l}g=document.createElement("canvas");b(g).attr("width",e(d.btOuterWidth(!0))+a.strokeWidth*2+o).attr("height",e(d.outerHeight(!0))+a.strokeWidth*2+s).appendTo(h).css({position:"absolute",
zIndex:a.boxzIndex});typeof G_vmlCanvasManager!="undefined"&&(g=G_vmlCanvasManager.initElement(g));if(a.cornerRadius>0){o=[];for(d=0;d<c.length;d++)c[d].type=="corner"?(s=G(c[d],c[(d-1)%c.length],a.cornerRadius),s.type="arcStart",o[o.length]=s,o[o.length]=c[d],s=G(c[d],c[(d+1)%c.length],a.cornerRadius),s.type="arcEnd",o[o.length]=s):o[o.length]=c[d];c=o}o=g.getContext("2d");if(a.shadow&&a.shadowOverlap!==!0)switch(s=e(a.shadowOverlap),u){case "top":a.shadowOffsetX+a.shadowBlur-s>0&&h.css("top",e(h.css("top"))-
(a.shadowOffsetX+a.shadowBlur-s));break;case "right":r-s>0&&h.css("left",e(h.css("left"))+r-s);break;case "bottom":w-s>0&&h.css("top",e(h.css("top"))+w-s);break;case "left":a.shadowOffsetY+a.shadowBlur-s>0&&h.css("left",e(h.css("left"))-(a.shadowOffsetY+a.shadowBlur-s))}y.apply(o,[c],a.strokeWidth);o.fillStyle=a.fill;if(a.shadow)o.shadowOffsetX=a.shadowOffsetX,o.shadowOffsetY=a.shadowOffsetY,o.shadowBlur=a.shadowBlur,o.shadowColor=a.shadowColor;o.closePath();o.fill();if(a.strokeWidth>0)o.shadowColor=
"rgba(0, 0, 0, 0)",o.lineWidth=a.strokeWidth,o.strokeStyle=a.strokeStyle,o.beginPath(),y.apply(o,[c],a.strokeWidth),o.closePath(),o.stroke();a.preShow.apply(this,[h[0]]);h.css({display:"none",visibility:"visible"});a.showTip.apply(this,[h[0]]);a.overlay&&(u=b('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:A,left:x,width:v,height:E,opacity:".2"}).appendTo(D),b(this).data("overlay",u));if(a.ajaxPath!=null&&a.ajaxCache==!1||t)m=!1;a.clickAnywhereToClose&&(jQuery.bt.vars.clickAnywhereStack.push(this),
b(document).click(jQuery.bt.docClick));a.closeWhenOthersOpen&&jQuery.bt.vars.closeWhenOpenStack.push(this);a.postShow.apply(this,[h[0]])}};this.btOff=function(){var e=b(this).data("bt-box");a.preHide.apply(this,[e]);var k=this;k.btCleanup=function(){var e=b(k).data("bt-box"),f=b(k).data("bt-content-orig"),m=b(k).data("bt-overlay");typeof e=="object"&&(b(e).remove(),b(k).removeData("bt-box"));typeof f=="object"&&(e=b(f.original).data("bt-clones"),b(f).data("bt-clones",z(e,f.clone)));typeof m=="object"&&
(b(m).remove(),b(k).removeData("bt-overlay"));jQuery.bt.vars.clickAnywhereStack=z(jQuery.bt.vars.clickAnywhereStack,k);jQuery.bt.vars.closeWhenOpenStack=z(jQuery.bt.vars.closeWhenOpenStack,k);b(k).removeClass("bt-active "+a.activeClass);a.postHide.apply(k)};a.hideTip.apply(this,[e,k.btCleanup])};this.btRefresh=function(){this.btOff();this.btOn()}})};jQuery.fn.btPosition=function(){function b(e,m){return e[0]&&parseInt(jQuery.curCSS(e[0],m,!0),10)||0}var n;if(this[0]){n=this.offsetParent();var y=this.offset(),
t=/^body|html$/i.test(n[0].tagName)?{top:0,left:0}:n.offset();y.top-=b(this,"marginTop");y.left-=b(this,"marginLeft");t.top+=b(n,"borderTopWidth");t.left+=b(n,"borderLeftWidth");n={top:y.top-t.top,left:y.left-t.left}}return n};jQuery.fn.btOuterWidth=function(b){function n(b,m){return b[0]&&parseInt(jQuery.curCSS(b[0],m,!0),10)||0}return this.innerWidth()+n(this,"borderLeftWidth")+n(this,"borderRightWidth")+(b?n(this,"marginLeft")+n(this,"marginRight"):0)};jQuery.fn.btOn=function(){return this.each(function(){jQuery.isFunction(this.btOn)&&
this.btOn()})};jQuery.fn.btOff=function(){return this.each(function(){jQuery.isFunction(this.btOff)&&this.btOff()})};jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]};jQuery.bt.docClick=function(m){if(!m)m=window.event;!b(m.target).parents().andSelf().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length&&(b(jQuery.bt.vars.clickAnywhereStack).btOff(),b(document).unbind("click",jQuery.bt.docClick))};jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:!0,
closeWhenOthersOpen:!1,shrinkToFit:!1,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:!1,killTitle:!0,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:0.5,centerPointY:0.5,shadow:!1,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:!1,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",
contentSelector:"$(this).attr('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:!0,ajaxOpts:{},preBuild:function(){},preShow:function(){},showTip:function(m){b(m).show()},postShow:function(){},preHide:function(){},hideTip:function(m,n){b(m).hide();n()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}};jQuery.bt.options={}})(jQuery);
